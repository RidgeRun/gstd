/* gstd-factory.c generated by valac 0.14.0, the Vala compiler
 * generated from gstd-factory.vala, do not modify */

/*
 * gstd/src/gstd-factory.vala
 *
 * GStreamer daemon pipeline Factory class - framework for controlling audio and video streaming using D-Bus messages
 *
 * Copyright (c) 2010, RidgeRun
 * All rights reserved.
 *
 * GPL2 license - See http://www.opensource.org/licenses/gpl-2.0.php for complete text.
 */

#include <glib.h>
#include <glib-object.h>
#include <gio/gio.h>
#include <stdlib.h>
#include <string.h>
#include <syslog.h>


#define TYPE_FACTORY (factory_get_type ())
#define FACTORY(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_FACTORY, Factory))
#define FACTORY_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_FACTORY, FactoryClass))
#define IS_FACTORY(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_FACTORY))
#define IS_FACTORY_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_FACTORY))
#define FACTORY_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_FACTORY, FactoryClass))

typedef struct _Factory Factory;
typedef struct _FactoryClass FactoryClass;
typedef struct _FactoryPrivate FactoryPrivate;

#define TYPE_PIPELINE (pipeline_get_type ())
#define PIPELINE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_PIPELINE, Pipeline))
#define PIPELINE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_PIPELINE, PipelineClass))
#define IS_PIPELINE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_PIPELINE))
#define IS_PIPELINE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_PIPELINE))
#define PIPELINE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_PIPELINE, PipelineClass))

typedef struct _Pipeline Pipeline;
typedef struct _PipelineClass PipelineClass;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))

struct _Factory {
	GObject parent_instance;
	FactoryPrivate * priv;
};

struct _FactoryClass {
	GObjectClass parent_class;
};

struct _FactoryPrivate {
	GDBusConnection* conn;
	Pipeline** pipes;
	gint pipes_length1;
	gint _pipes_size_;
};


static gpointer factory_parent_class = NULL;

GType factory_get_type (void) G_GNUC_CONST;
guint factory_register_object (void* object, GDBusConnection* connection, const gchar* path, GError** error);
GType pipeline_get_type (void) G_GNUC_CONST;
guint pipeline_register_object (void* object, GDBusConnection* connection, const gchar* path, GError** error);
#define FACTORY_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), TYPE_FACTORY, FactoryPrivate))
enum  {
	FACTORY_DUMMY_PROPERTY
};
#define FACTORY_num_pipes 20
Factory* factory_new (GDBusConnection* conn);
Factory* factory_construct (GType object_type, GDBusConnection* conn);
gchar* factory_Create (Factory* self, const gchar* description);
Pipeline* pipeline_new (const gchar* description);
Pipeline* pipeline_construct (GType object_type, const gchar* description);
gboolean pipeline_PipelineIsInitialized (Pipeline* self);
gboolean pipeline_PipelineSetPath (Pipeline* self, const gchar* dbuspath);
gboolean factory_Destroy (Factory* self, const gchar* objectpath);
gchar* pipeline_PipelineGetPath (Pipeline* self);
gboolean factory_DestroyAll (Factory* self);
gchar** factory_List (Factory* self, int* result_length1);
static void _vala_array_add1 (gchar*** array, int* length, int* size, gchar* value);
gboolean factory_Ping (Factory* self);
static void factory_finalize (GObject* obj);
static void _dbus_factory_Create (Factory* self, GVariant* parameters, GDBusMethodInvocation* invocation);
static void _dbus_factory_Destroy (Factory* self, GVariant* parameters, GDBusMethodInvocation* invocation);
static void _dbus_factory_DestroyAll (Factory* self, GVariant* parameters, GDBusMethodInvocation* invocation);
static void _dbus_factory_List (Factory* self, GVariant* parameters, GDBusMethodInvocation* invocation);
static void _dbus_factory_Ping (Factory* self, GVariant* parameters, GDBusMethodInvocation* invocation);
static void factory_dbus_interface_method_call (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* method_name, GVariant* parameters, GDBusMethodInvocation* invocation, gpointer user_data);
static GVariant* factory_dbus_interface_get_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GError** error, gpointer user_data);
static gboolean factory_dbus_interface_set_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GVariant* value, GError** error, gpointer user_data);
static void _factory_unregister_object (gpointer user_data);
static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func);

static const GDBusArgInfo _factory_dbus_arg_info_Create_description = {-1, "description", "s"};
static const GDBusArgInfo _factory_dbus_arg_info_Create_result = {-1, "result", "s"};
static const GDBusArgInfo * const _factory_dbus_arg_info_Create_in[] = {&_factory_dbus_arg_info_Create_description, NULL};
static const GDBusArgInfo * const _factory_dbus_arg_info_Create_out[] = {&_factory_dbus_arg_info_Create_result, NULL};
static const GDBusMethodInfo _factory_dbus_method_info_Create = {-1, "Create", (GDBusArgInfo **) (&_factory_dbus_arg_info_Create_in), (GDBusArgInfo **) (&_factory_dbus_arg_info_Create_out)};
static const GDBusArgInfo _factory_dbus_arg_info_Destroy_objectpath = {-1, "objectpath", "s"};
static const GDBusArgInfo _factory_dbus_arg_info_Destroy_result = {-1, "result", "b"};
static const GDBusArgInfo * const _factory_dbus_arg_info_Destroy_in[] = {&_factory_dbus_arg_info_Destroy_objectpath, NULL};
static const GDBusArgInfo * const _factory_dbus_arg_info_Destroy_out[] = {&_factory_dbus_arg_info_Destroy_result, NULL};
static const GDBusMethodInfo _factory_dbus_method_info_Destroy = {-1, "Destroy", (GDBusArgInfo **) (&_factory_dbus_arg_info_Destroy_in), (GDBusArgInfo **) (&_factory_dbus_arg_info_Destroy_out)};
static const GDBusArgInfo _factory_dbus_arg_info_DestroyAll_result = {-1, "result", "b"};
static const GDBusArgInfo * const _factory_dbus_arg_info_DestroyAll_in[] = {NULL};
static const GDBusArgInfo * const _factory_dbus_arg_info_DestroyAll_out[] = {&_factory_dbus_arg_info_DestroyAll_result, NULL};
static const GDBusMethodInfo _factory_dbus_method_info_DestroyAll = {-1, "DestroyAll", (GDBusArgInfo **) (&_factory_dbus_arg_info_DestroyAll_in), (GDBusArgInfo **) (&_factory_dbus_arg_info_DestroyAll_out)};
static const GDBusArgInfo _factory_dbus_arg_info_List_result = {-1, "result", "as"};
static const GDBusArgInfo * const _factory_dbus_arg_info_List_in[] = {NULL};
static const GDBusArgInfo * const _factory_dbus_arg_info_List_out[] = {&_factory_dbus_arg_info_List_result, NULL};
static const GDBusMethodInfo _factory_dbus_method_info_List = {-1, "List", (GDBusArgInfo **) (&_factory_dbus_arg_info_List_in), (GDBusArgInfo **) (&_factory_dbus_arg_info_List_out)};
static const GDBusArgInfo _factory_dbus_arg_info_Ping_result = {-1, "result", "b"};
static const GDBusArgInfo * const _factory_dbus_arg_info_Ping_in[] = {NULL};
static const GDBusArgInfo * const _factory_dbus_arg_info_Ping_out[] = {&_factory_dbus_arg_info_Ping_result, NULL};
static const GDBusMethodInfo _factory_dbus_method_info_Ping = {-1, "Ping", (GDBusArgInfo **) (&_factory_dbus_arg_info_Ping_in), (GDBusArgInfo **) (&_factory_dbus_arg_info_Ping_out)};
static const GDBusMethodInfo * const _factory_dbus_method_info[] = {&_factory_dbus_method_info_Create, &_factory_dbus_method_info_Destroy, &_factory_dbus_method_info_DestroyAll, &_factory_dbus_method_info_List, &_factory_dbus_method_info_Ping, NULL};
static const GDBusSignalInfo * const _factory_dbus_signal_info[] = {NULL};
static const GDBusPropertyInfo * const _factory_dbus_property_info[] = {NULL};
static const GDBusInterfaceInfo _factory_dbus_interface_info = {-1, "com.ridgerun.gstreamer.gstd.FactoryInterface", (GDBusMethodInfo **) (&_factory_dbus_method_info), (GDBusSignalInfo **) (&_factory_dbus_signal_info), (GDBusPropertyInfo **) (&_factory_dbus_property_info)};
static const GDBusInterfaceVTable _factory_dbus_interface_vtable = {factory_dbus_interface_method_call, factory_dbus_interface_get_property, factory_dbus_interface_set_property};

/**
   Create a new instance of a factory server to process D-Bus
   factory messages
 */
static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


Factory* factory_construct (GType object_type, GDBusConnection* conn) {
	Factory * self = NULL;
	GDBusConnection* _tmp0_;
	GDBusConnection* _tmp1_;
	Pipeline** _tmp2_ = NULL;
	g_return_val_if_fail (conn != NULL, NULL);
	self = (Factory*) g_object_new (object_type, NULL);
	_tmp0_ = conn;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (self->priv->conn);
	self->priv->conn = _tmp1_;
	_tmp2_ = g_new0 (Pipeline*, FACTORY_num_pipes + 1);
	self->priv->pipes = (_vala_array_free (self->priv->pipes, self->priv->pipes_length1, (GDestroyNotify) g_object_unref), NULL);
	self->priv->pipes = _tmp2_;
	self->priv->pipes_length1 = FACTORY_num_pipes;
	self->priv->_pipes_size_ = self->priv->pipes_length1;
	{
		gint ids;
		ids = 0;
		{
			gboolean _tmp3_;
			_tmp3_ = TRUE;
			while (TRUE) {
				gboolean _tmp4_;
				gint _tmp6_;
				Pipeline** _tmp7_;
				gint _tmp7__length1;
				Pipeline** _tmp8_;
				gint _tmp8__length1;
				gint _tmp9_;
				Pipeline* _tmp10_;
				_tmp4_ = _tmp3_;
				if (!_tmp4_) {
					gint _tmp5_;
					_tmp5_ = ids;
					ids = _tmp5_ + 1;
				}
				_tmp3_ = FALSE;
				_tmp6_ = ids;
				_tmp7_ = self->priv->pipes;
				_tmp7__length1 = self->priv->pipes_length1;
				if (!(_tmp6_ < _tmp7__length1)) {
					break;
				}
				_tmp8_ = self->priv->pipes;
				_tmp8__length1 = self->priv->pipes_length1;
				_tmp9_ = ids;
				_g_object_unref0 (_tmp8_[_tmp9_]);
				_tmp8_[_tmp9_] = NULL;
				_tmp10_ = _tmp8_[_tmp9_];
			}
		}
	}
	return self;
}


Factory* factory_new (GDBusConnection* conn) {
	return factory_construct (TYPE_FACTORY, conn);
}


/**
   Creates a pipeline from a gst-launch like description using or not
   debug information
   @param description, gst-launch like description of the pipeline
   @param debug, flag to enable debug information
   @return the dbus-path of the pipeline, or null if out of resources
 */
gchar* factory_Create (Factory* self, const gchar* description) {
	gchar* result = NULL;
	GError * _inner_error_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (description != NULL, NULL);
	{
		gint next_id;
		Pipeline** _tmp7_;
		gint _tmp7__length1;
		gint _tmp8_;
		const gchar* _tmp9_;
		Pipeline* _tmp10_;
		Pipeline* _tmp11_;
		Pipeline** _tmp12_;
		gint _tmp12__length1;
		gint _tmp13_;
		Pipeline* _tmp14_;
		gboolean _tmp15_ = FALSE;
		gint _tmp20_;
		gchar* _tmp21_ = NULL;
		gchar* _tmp22_;
		gchar* _tmp23_;
		gchar* _tmp24_;
		gchar* objectpath;
		GDBusConnection* _tmp25_;
		const gchar* _tmp26_;
		Pipeline** _tmp27_;
		gint _tmp27__length1;
		gint _tmp28_;
		Pipeline* _tmp29_;
		Pipeline** _tmp30_;
		gint _tmp30__length1;
		gint _tmp31_;
		Pipeline* _tmp32_;
		const gchar* _tmp33_;
		next_id = 0;
		while (TRUE) {
			Pipeline** _tmp0_;
			gint _tmp0__length1;
			gint _tmp1_;
			Pipeline* _tmp2_;
			gint _tmp3_;
			Pipeline** _tmp4_;
			gint _tmp4__length1;
			gint _tmp5_;
			_tmp0_ = self->priv->pipes;
			_tmp0__length1 = self->priv->pipes_length1;
			_tmp1_ = next_id;
			_tmp2_ = _tmp0_[_tmp1_];
			if (!(_tmp2_ != NULL)) {
				break;
			}
			_tmp3_ = next_id;
			_tmp4_ = self->priv->pipes;
			_tmp4__length1 = self->priv->pipes_length1;
			next_id = (_tmp3_ + 1) % _tmp4__length1;
			_tmp5_ = next_id;
			if (_tmp5_ == 0) {
				gchar* _tmp6_;
				_tmp6_ = g_strdup ("");
				result = _tmp6_;
				return result;
			}
		}
		_tmp7_ = self->priv->pipes;
		_tmp7__length1 = self->priv->pipes_length1;
		_tmp8_ = next_id;
		_tmp9_ = description;
		_tmp10_ = pipeline_new (_tmp9_);
		_g_object_unref0 (_tmp7_[_tmp8_]);
		_tmp7_[_tmp8_] = _tmp10_;
		_tmp11_ = _tmp7_[_tmp8_];
		_tmp12_ = self->priv->pipes;
		_tmp12__length1 = self->priv->pipes_length1;
		_tmp13_ = next_id;
		_tmp14_ = _tmp12_[_tmp13_];
		_tmp15_ = pipeline_PipelineIsInitialized (_tmp14_);
		if (!_tmp15_) {
			Pipeline** _tmp16_;
			gint _tmp16__length1;
			gint _tmp17_;
			Pipeline* _tmp18_;
			gchar* _tmp19_;
			_tmp16_ = self->priv->pipes;
			_tmp16__length1 = self->priv->pipes_length1;
			_tmp17_ = next_id;
			_g_object_unref0 (_tmp16_[_tmp17_]);
			_tmp16_[_tmp17_] = NULL;
			_tmp18_ = _tmp16_[_tmp17_];
			_tmp19_ = g_strdup ("");
			result = _tmp19_;
			return result;
		}
		_tmp20_ = next_id;
		_tmp21_ = g_strdup_printf ("%i", _tmp20_);
		_tmp22_ = _tmp21_;
		_tmp23_ = g_strconcat ("/com/ridgerun/gstreamer/gstd/pipe", _tmp22_, NULL);
		_tmp24_ = _tmp23_;
		_g_free0 (_tmp22_);
		objectpath = _tmp24_;
		_tmp25_ = self->priv->conn;
		_tmp26_ = objectpath;
		_tmp27_ = self->priv->pipes;
		_tmp27__length1 = self->priv->pipes_length1;
		_tmp28_ = next_id;
		_tmp29_ = _tmp27_[_tmp28_];
		pipeline_register_object (_tmp29_, _tmp25_, _tmp26_, &_inner_error_);
		if (_inner_error_ != NULL) {
			_g_free0 (objectpath);
			if (_inner_error_->domain == G_IO_ERROR) {
				goto __catch3_g_io_error;
			}
			_g_free0 (objectpath);
			g_critical ("file %s: line %d: unexpected error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
			g_clear_error (&_inner_error_);
			return NULL;
		}
		_tmp30_ = self->priv->pipes;
		_tmp30__length1 = self->priv->pipes_length1;
		_tmp31_ = next_id;
		_tmp32_ = _tmp30_[_tmp31_];
		_tmp33_ = objectpath;
		pipeline_PipelineSetPath (_tmp32_, _tmp33_);
		result = objectpath;
		return result;
	}
	goto __finally3;
	__catch3_g_io_error:
	{
		GError* _error_ = NULL;
		gchar* _tmp34_;
		_error_ = _inner_error_;
		_inner_error_ = NULL;
		_tmp34_ = g_strdup ("");
		result = _tmp34_;
		_g_error_free0 (_error_);
		return result;
	}
	__finally3:
	g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
	g_clear_error (&_inner_error_);
	return NULL;
}


/**
   Destroy a pipeline
   @param id, the pipeline id assigned when created
   @return true, if succeded
   @see PipelineId
 */
gboolean factory_Destroy (Factory* self, const gchar* objectpath) {
	gboolean result = FALSE;
	g_return_val_if_fail (self != NULL, FALSE);
	g_return_val_if_fail (objectpath != NULL, FALSE);
	{
		gint index;
		index = 0;
		{
			gboolean _tmp0_;
			_tmp0_ = TRUE;
			while (TRUE) {
				gboolean _tmp1_;
				gint _tmp3_;
				Pipeline** _tmp4_;
				gint _tmp4__length1;
				Pipeline** _tmp5_;
				gint _tmp5__length1;
				gint _tmp6_;
				Pipeline* _tmp7_;
				_tmp1_ = _tmp0_;
				if (!_tmp1_) {
					gint _tmp2_;
					_tmp2_ = index;
					index = _tmp2_ + 1;
				}
				_tmp0_ = FALSE;
				_tmp3_ = index;
				_tmp4_ = self->priv->pipes;
				_tmp4__length1 = self->priv->pipes_length1;
				if (!(_tmp3_ < _tmp4__length1)) {
					break;
				}
				_tmp5_ = self->priv->pipes;
				_tmp5__length1 = self->priv->pipes_length1;
				_tmp6_ = index;
				_tmp7_ = _tmp5_[_tmp6_];
				if (_tmp7_ != NULL) {
					Pipeline** _tmp8_;
					gint _tmp8__length1;
					gint _tmp9_;
					Pipeline* _tmp10_;
					gchar* _tmp11_ = NULL;
					gchar* _tmp12_;
					const gchar* _tmp13_;
					gboolean _tmp14_;
					_tmp8_ = self->priv->pipes;
					_tmp8__length1 = self->priv->pipes_length1;
					_tmp9_ = index;
					_tmp10_ = _tmp8_[_tmp9_];
					_tmp11_ = pipeline_PipelineGetPath (_tmp10_);
					_tmp12_ = _tmp11_;
					_tmp13_ = objectpath;
					_tmp14_ = g_strcmp0 (_tmp12_, _tmp13_) == 0;
					_g_free0 (_tmp12_);
					if (_tmp14_) {
						Pipeline** _tmp15_;
						gint _tmp15__length1;
						gint _tmp16_;
						Pipeline* _tmp17_;
						_tmp15_ = self->priv->pipes;
						_tmp15__length1 = self->priv->pipes_length1;
						_tmp16_ = index;
						_g_object_unref0 (_tmp15_[_tmp16_]);
						_tmp15_[_tmp16_] = NULL;
						_tmp17_ = _tmp15_[_tmp16_];
						result = TRUE;
						return result;
					}
				}
			}
		}
	}
	syslog (LOG_ERR, "Fail to destroy pipeline", NULL);
	result = FALSE;
	return result;
}


/**
   Destroy all pipelines
   @return true, if succeded
   @see PipelineId
 */
gboolean factory_DestroyAll (Factory* self) {
	gboolean result = FALSE;
	g_return_val_if_fail (self != NULL, FALSE);
	{
		gint index;
		index = 0;
		{
			gboolean _tmp0_;
			_tmp0_ = TRUE;
			while (TRUE) {
				gboolean _tmp1_;
				gint _tmp3_;
				Pipeline** _tmp4_;
				gint _tmp4__length1;
				Pipeline** _tmp5_;
				gint _tmp5__length1;
				gint _tmp6_;
				Pipeline* _tmp7_;
				_tmp1_ = _tmp0_;
				if (!_tmp1_) {
					gint _tmp2_;
					_tmp2_ = index;
					index = _tmp2_ + 1;
				}
				_tmp0_ = FALSE;
				_tmp3_ = index;
				_tmp4_ = self->priv->pipes;
				_tmp4__length1 = self->priv->pipes_length1;
				if (!(_tmp3_ < _tmp4__length1)) {
					break;
				}
				_tmp5_ = self->priv->pipes;
				_tmp5__length1 = self->priv->pipes_length1;
				_tmp6_ = index;
				_tmp7_ = _tmp5_[_tmp6_];
				if (_tmp7_ != NULL) {
					Pipeline** _tmp8_;
					gint _tmp8__length1;
					gint _tmp9_;
					Pipeline* _tmp10_;
					_tmp8_ = self->priv->pipes;
					_tmp8__length1 = self->priv->pipes_length1;
					_tmp9_ = index;
					_g_object_unref0 (_tmp8_[_tmp9_]);
					_tmp8_[_tmp9_] = NULL;
					_tmp10_ = _tmp8_[_tmp9_];
				}
			}
		}
	}
	result = TRUE;
	return result;
}


/**
   List the existing pipelines
   @return pipe_list with the corresponding paths
 */
static void _vala_array_add1 (gchar*** array, int* length, int* size, gchar* value) {
	if ((*length) == (*size)) {
		*size = (*size) ? (2 * (*size)) : 4;
		*array = g_renew (gchar*, *array, (*size) + 1);
	}
	(*array)[(*length)++] = value;
	(*array)[*length] = NULL;
}


gchar** factory_List (Factory* self, int* result_length1) {
	gchar** result = NULL;
	gchar** _tmp0_ = NULL;
	gchar** paths;
	gint paths_length1;
	gint _paths_size_;
	gchar** _tmp14_;
	gint _tmp14__length1;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = g_new0 (gchar*, 0 + 1);
	paths = _tmp0_;
	paths_length1 = 0;
	_paths_size_ = paths_length1;
	{
		gint index;
		index = 0;
		{
			gboolean _tmp1_;
			_tmp1_ = TRUE;
			while (TRUE) {
				gboolean _tmp2_;
				gint _tmp4_;
				Pipeline** _tmp5_;
				gint _tmp5__length1;
				Pipeline** _tmp6_;
				gint _tmp6__length1;
				gint _tmp7_;
				Pipeline* _tmp8_;
				_tmp2_ = _tmp1_;
				if (!_tmp2_) {
					gint _tmp3_;
					_tmp3_ = index;
					index = _tmp3_ + 1;
				}
				_tmp1_ = FALSE;
				_tmp4_ = index;
				_tmp5_ = self->priv->pipes;
				_tmp5__length1 = self->priv->pipes_length1;
				if (!(_tmp4_ < _tmp5__length1)) {
					break;
				}
				_tmp6_ = self->priv->pipes;
				_tmp6__length1 = self->priv->pipes_length1;
				_tmp7_ = index;
				_tmp8_ = _tmp6_[_tmp7_];
				if (_tmp8_ != NULL) {
					gchar** _tmp9_;
					gint _tmp9__length1;
					Pipeline** _tmp10_;
					gint _tmp10__length1;
					gint _tmp11_;
					Pipeline* _tmp12_;
					gchar* _tmp13_ = NULL;
					_tmp9_ = paths;
					_tmp9__length1 = paths_length1;
					_tmp10_ = self->priv->pipes;
					_tmp10__length1 = self->priv->pipes_length1;
					_tmp11_ = index;
					_tmp12_ = _tmp10_[_tmp11_];
					_tmp13_ = pipeline_PipelineGetPath (_tmp12_);
					_vala_array_add1 (&paths, &paths_length1, &_paths_size_, _tmp13_);
				}
			}
		}
	}
	_tmp14_ = paths;
	_tmp14__length1 = paths_length1;
	if (result_length1) {
		*result_length1 = _tmp14__length1;
	}
	result = _tmp14_;
	return result;
}


/**
   Ping Gstd daemon.
   Some GStreamer elements use exit(), thus killing the daemon.
   @return true if alive
 */
gboolean factory_Ping (Factory* self) {
	gboolean result = FALSE;
	g_return_val_if_fail (self != NULL, FALSE);
	result = TRUE;
	return result;
}


static void factory_class_init (FactoryClass * klass) {
	factory_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (FactoryPrivate));
	G_OBJECT_CLASS (klass)->finalize = factory_finalize;
}


static void factory_instance_init (Factory * self) {
	self->priv = FACTORY_GET_PRIVATE (self);
}


static void factory_finalize (GObject* obj) {
	Factory * self;
	self = FACTORY (obj);
	_g_object_unref0 (self->priv->conn);
	self->priv->pipes = (_vala_array_free (self->priv->pipes, self->priv->pipes_length1, (GDestroyNotify) g_object_unref), NULL);
	G_OBJECT_CLASS (factory_parent_class)->finalize (obj);
}


GType factory_get_type (void) {
	static volatile gsize factory_type_id__volatile = 0;
	if (g_once_init_enter (&factory_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (FactoryClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) factory_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (Factory), 0, (GInstanceInitFunc) factory_instance_init, NULL };
		GType factory_type_id;
		factory_type_id = g_type_register_static (G_TYPE_OBJECT, "Factory", &g_define_type_info, 0);
		g_type_set_qdata (factory_type_id, g_quark_from_static_string ("vala-dbus-register-object"), (void*) factory_register_object);
		g_once_init_leave (&factory_type_id__volatile, factory_type_id);
	}
	return factory_type_id__volatile;
}


static void _dbus_factory_Create (Factory* self, GVariant* parameters, GDBusMethodInvocation* invocation) {
	GError* error = NULL;
	GVariantIter _arguments_iter;
	gchar* description = NULL;
	GVariant* _tmp0_;
	GDBusMessage* _reply_message;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	gchar* result;
	g_variant_iter_init (&_arguments_iter, parameters);
	_tmp0_ = g_variant_iter_next_value (&_arguments_iter);
	description = g_variant_dup_string (_tmp0_, NULL);
	g_variant_unref (_tmp0_);
	result = factory_Create (self, description);
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (result));
	_g_free0 (result);
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_message_set_body (_reply_message, _reply);
	_g_free0 (description);
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
	g_object_unref (invocation);
	g_object_unref (_reply_message);
}


static void _dbus_factory_Destroy (Factory* self, GVariant* parameters, GDBusMethodInvocation* invocation) {
	GError* error = NULL;
	GVariantIter _arguments_iter;
	gchar* objectpath = NULL;
	GVariant* _tmp1_;
	GDBusMessage* _reply_message;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	gboolean result;
	g_variant_iter_init (&_arguments_iter, parameters);
	_tmp1_ = g_variant_iter_next_value (&_arguments_iter);
	objectpath = g_variant_dup_string (_tmp1_, NULL);
	g_variant_unref (_tmp1_);
	result = factory_Destroy (self, objectpath);
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_boolean (result));
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_message_set_body (_reply_message, _reply);
	_g_free0 (objectpath);
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
	g_object_unref (invocation);
	g_object_unref (_reply_message);
}


static void _dbus_factory_DestroyAll (Factory* self, GVariant* parameters, GDBusMethodInvocation* invocation) {
	GError* error = NULL;
	GVariantIter _arguments_iter;
	GDBusMessage* _reply_message;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	gboolean result;
	g_variant_iter_init (&_arguments_iter, parameters);
	result = factory_DestroyAll (self);
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_boolean (result));
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_message_set_body (_reply_message, _reply);
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
	g_object_unref (invocation);
	g_object_unref (_reply_message);
}


static void _dbus_factory_List (Factory* self, GVariant* parameters, GDBusMethodInvocation* invocation) {
	GError* error = NULL;
	GVariantIter _arguments_iter;
	GDBusMessage* _reply_message;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	gchar** result;
	int result_length1 = 0;
	gchar** _tmp2_;
	GVariantBuilder _tmp3_;
	int _tmp4_;
	g_variant_iter_init (&_arguments_iter, parameters);
	result = factory_List (self, &result_length1);
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	_tmp2_ = result;
	g_variant_builder_init (&_tmp3_, G_VARIANT_TYPE ("as"));
	for (_tmp4_ = 0; _tmp4_ < result_length1; _tmp4_++) {
		g_variant_builder_add_value (&_tmp3_, g_variant_new_string (*_tmp2_));
		_tmp2_++;
	}
	g_variant_builder_add_value (&_reply_builder, g_variant_builder_end (&_tmp3_));
	result = (_vala_array_free (result, result_length1, (GDestroyNotify) g_free), NULL);
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_message_set_body (_reply_message, _reply);
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
	g_object_unref (invocation);
	g_object_unref (_reply_message);
}


static void _dbus_factory_Ping (Factory* self, GVariant* parameters, GDBusMethodInvocation* invocation) {
	GError* error = NULL;
	GVariantIter _arguments_iter;
	GDBusMessage* _reply_message;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	gboolean result;
	g_variant_iter_init (&_arguments_iter, parameters);
	result = factory_Ping (self);
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_boolean (result));
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_message_set_body (_reply_message, _reply);
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
	g_object_unref (invocation);
	g_object_unref (_reply_message);
}


static void factory_dbus_interface_method_call (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* method_name, GVariant* parameters, GDBusMethodInvocation* invocation, gpointer user_data) {
	gpointer* data;
	gpointer object;
	data = user_data;
	object = data[0];
	if (strcmp (method_name, "Create") == 0) {
		_dbus_factory_Create (object, parameters, invocation);
	} else if (strcmp (method_name, "Destroy") == 0) {
		_dbus_factory_Destroy (object, parameters, invocation);
	} else if (strcmp (method_name, "DestroyAll") == 0) {
		_dbus_factory_DestroyAll (object, parameters, invocation);
	} else if (strcmp (method_name, "List") == 0) {
		_dbus_factory_List (object, parameters, invocation);
	} else if (strcmp (method_name, "Ping") == 0) {
		_dbus_factory_Ping (object, parameters, invocation);
	} else {
		g_object_unref (invocation);
	}
}


static GVariant* factory_dbus_interface_get_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GError** error, gpointer user_data) {
	gpointer* data;
	gpointer object;
	data = user_data;
	object = data[0];
	return NULL;
}


static gboolean factory_dbus_interface_set_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GVariant* value, GError** error, gpointer user_data) {
	gpointer* data;
	gpointer object;
	data = user_data;
	object = data[0];
	return FALSE;
}


guint factory_register_object (gpointer object, GDBusConnection* connection, const gchar* path, GError** error) {
	guint result;
	gpointer *data;
	data = g_new (gpointer, 3);
	data[0] = g_object_ref (object);
	data[1] = g_object_ref (connection);
	data[2] = g_strdup (path);
	result = g_dbus_connection_register_object (connection, path, (GDBusInterfaceInfo *) (&_factory_dbus_interface_info), &_factory_dbus_interface_vtable, data, _factory_unregister_object, error);
	if (!result) {
		return 0;
	}
	return result;
}


static void _factory_unregister_object (gpointer user_data) {
	gpointer* data;
	data = user_data;
	g_object_unref (data[0]);
	g_object_unref (data[1]);
	g_free (data[2]);
	g_free (data);
}


static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	if ((array != NULL) && (destroy_func != NULL)) {
		int i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}


static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}



